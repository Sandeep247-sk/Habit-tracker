:root {
  /* Dark Blue Galaxy Theme Palette */
  --bg-primary: #02040a; /* Very deep blue-black */
  --bg-secondary: #0a1128; /* Dark royal blue hood */
  --card-bg: rgba(16, 24, 48, 0.7); /* Glassmorphism Blue */
  --card-border: rgba(67, 97, 238, 0.3);

  --accent-blue: #4361ee; /* Royal Blue */
  --accent-light: #4cc9f0; /* Neon Cyan */
  --accent-secondary: #3f37c9; /* Deep Indigo */
  --accent-glow: #4895ef; /* Blue Glow */

  --text-primary: #f0f6fc;
  --text-secondary: #8b9bb4;

  --success-check: #4cc9f0; /* Cyan Neon */
  --danger: #ef233c;

  --glow: rgba(67, 97, 238, 0.6);
  --glow-strong: rgba(76, 201, 240, 0.8);

  /* Spacing & Radius */
  --radius-md: 12px;
  --radius-lg: 20px;
  --spacing-sm: 8px;
  --spacing-md: 16px;
  --spacing-lg: 24px;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: "Poppins", "Inter", sans-serif;
}

body {
  background-color: var(--bg-primary);
  background-image:
    radial-gradient(
      circle at 15% 50%,
      rgba(67, 97, 238, 0.15) 0%,
      transparent 30%
    ),
    radial-gradient(
      circle at 85% 30%,
      rgba(76, 201, 240, 0.1) 0%,
      transparent 30%
    );
  background-attachment: fixed;
  color: var(--text-primary);
  min-height: 100vh;
  padding: 20px;
  display: flex;
  justify-content: center;
}

/* Custom Scrollbar */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}
::-webkit-scrollbar-track {
  background: var(--bg-primary);
}
::-webkit-scrollbar-thumb {
  background: var(--accent-blue);
  border-radius: 4px;
}

.app-container {
  width: 100%;
  max-width: 1200px;
  display: flex;
  flex-direction: column;
  gap: var(--spacing-lg);
}

/* HEADER */
header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: var(--card-bg);
  backdrop-filter: blur(10px);
  padding: var(--spacing-md) var(--spacing-lg);
  border-radius: var(--radius-lg);
  border: 1px solid var(--card-border);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
}

.header-left h1 {
  font-size: 1.8rem;
  font-weight: 700;
  margin-bottom: 5px;
  background: linear-gradient(90deg, #fff, #4cc9f0);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  text-shadow: 0 0 20px rgba(67, 97, 238, 0.3);
}

.date-selectors select {
  background: rgba(12, 15, 36, 0.8);
  color: var(--text-primary);
  border: 1px solid var(--card-border);
  padding: 6px 12px;
  border-radius: 8px;
  outline: none;
  cursor: pointer;
  transition: box-shadow 0.2s;
}
.date-selectors select:hover {
  box-shadow: 0 0 10px var(--glow);
  border-color: var(--accent-light);
}

.header-controls {
  display: flex;
  gap: 10px;
}

/* BUTTONS */
.btn {
  padding: 10px 20px;
  border-radius: 12px;
  border: none;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

.btn-primary {
  background: linear-gradient(
    135deg,
    var(--accent-secondary),
    var(--accent-blue)
  );
  color: white;
  box-shadow: 0 4px 15px rgba(67, 97, 238, 0.4);
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(67, 97, 238, 0.6);
}

.btn-secondary {
  background: rgba(255, 255, 255, 0.05);
  color: var(--text-secondary);
  border: 1px solid var(--card-border);
}

.btn-secondary:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: var(--text-primary);
  color: var(--text-primary);
}

.btn-outline {
  background: transparent;
  border: 1px solid var(--accent-light);
  color: var(--accent-light);
}

.btn-outline:hover {
  background: rgba(67, 97, 238, 0.1);
  box-shadow: 0 0 12px var(--glow);
}

/* TABS */
.tracker-tabs {
  display: flex;
  gap: 15px;
  padding: 5px;
}

.tab-btn {
  background: transparent;
  border: none;
  color: var(--text-secondary);
  padding: 8px 20px;
  font-size: 1rem;
  cursor: pointer;
  border-bottom: 2px solid transparent;
  transition: all 0.3s;
  letter-spacing: 0.5px;
}

.tab-btn:hover {
  color: var(--text-primary);
}

.tab-btn.active {
  color: var(--accent-light);
  border-bottom-color: var(--accent-light);
  text-shadow: 0 0 10px var(--glow);
}

/* WEEK CONTROLS */
.week-controls {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 20px;
  margin-bottom: 10px;
}

.week-controls span {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--accent-light);
}

.btn-nav {
  background: var(--card-bg);
  border: 1px solid var(--card-border);
  color: var(--text-primary);
  width: 32px;
  height: 32px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.btn-nav:hover {
  background: var(--accent-blue);
  box-shadow: 0 0 10px var(--glow);
}

/* MAIN GRID - Transposed Layout */
.tracker-grid-container {
  background: var(--card-bg);
  backdrop-filter: blur(10px);
  border-radius: var(--radius-lg);
  padding: var(--spacing-md);
  border: 1px solid var(--card-border);
  overflow-x: auto; /* Only enable horizontal scroll */
  overflow-y: visible; /* Show full height */
  position: relative;
  display: grid;
  grid-template-rows: auto 1fr;
  min-height: auto; /* Let content dictate height */
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
}

.grid-header {
  display: flex;
  border-bottom: 1px solid var(--card-border);
  padding-bottom: 0; /* Remove padding to let borders connect */
  position: sticky;
  top: 0;
  background: rgba(12, 15, 36, 0.95);
  z-index: 30;
  width: max-content;
  min-width: 100%;
}

.date-col-header {
  width: 120px;
  flex-shrink: 0;
  font-weight: 600;
  padding-left: 20px;
  position: sticky;
  left: 0;
  top: 0;
  background: rgba(12, 15, 36, 0.95);
  z-index: 40; /* Highest z-index for top-left corner */
  border-right: 1px solid var(--card-border);
  display: flex;
  align-items: center;
  color: var(--accent-light);
  height: auto; /* Allow it to stretch */
}

.habits-header {
  display: flex;
  flex-grow: 1;
}

.habit-col-title {
  /* width is now set via inline style */
  text-align: center;
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 10px 5px; /* Add vertical padding internally */
  position: relative;
  gap: 5px; /* Add gap between input and delete btn */
  border-right: 1px solid rgba(255, 255, 255, 0.1); /* Vertical separator */
  transition: width 0.05s ease; /* Smooth resize but fast enough */
  overflow: hidden; /* Hide content when shrinking */
}

/* RESIZE HANDLE */
.resize-handle {
  position: absolute;
  right: 0;
  top: 0;
  bottom: 0;
  width: 6px;
  cursor: col-resize;
  z-index: 10;
  grid-column: 200; /* Ensure on top */
}

.resize-handle:hover {
  background: rgba(76, 201, 240, 0.5); /* Highlight on hover */
}

/* COLLAPSED STATE */
.habit-col-title.collapsed .habit-name-input,
.habit-col-title.collapsed .delete-habit-btn {
  display: none;
}

.habit-col-title.collapsed {
  padding: 0;
  justify-content: center;
}

/* ... existing styles ... */

.check-cell {
  width: 150px;
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  border-right: 1px solid rgba(255, 255, 255, 0.1); /* Vertical separator matching header */
}

/* Remove border from the last column if desired, though flexible width might make it look odd if not consistent. 
   Let's keep it for consistency or remove it for the very last one. */
.habit-col-title:last-child,
.check-cell:last-child {
  border-right: none;
}

.habit-col-title .habit-icon-input {
  background: transparent;
  border: none;
  color: var(--text-primary);
  font-size: 1.5rem;
  width: 40px;
  text-align: center;
  cursor: pointer;
}

.habit-col-title .habit-icon-input:focus {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 4px;
  outline: none;
}

.habit-col-title .habit-name-input {
  text-align: center;
  font-weight: 600;
  background: transparent;
  border: 1px solid transparent; /* Invisible border */
  color: var(--text-primary);
  width: 100%;
}

.habit-col-title .habit-name-input:focus {
  background: rgba(255, 255, 255, 0.1);
  border-color: var(--accent-blue);
  box-shadow: 0 0 10px var(--glow);
}

/* DAY ROWS */
/* DAY ROWS */
.days-rows-container {
  width: max-content; /* Ensure it grows with content */
  min-width: 100%;
  padding-top: 0; /* Remove gap so borders connect */
}

.day-row {
  display: flex;
  align-items: stretch; /* Ensure cells stretch to fill row height */
  /* Remove padding from row so borders extend full height */
  padding: 0;
  border-bottom: 1px solid rgba(67, 97, 238, 0.1);
  transition: background 0.2s;
}

.day-row:hover {
  background: rgba(67, 97, 238, 0.05);
}

.day-label-cell {
  width: 120px;
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  justify-content: center;
  padding: 12px 0 12px 20px; /* moved padding here */
  position: sticky;
  left: 0;
  background: rgba(12, 15, 36, 0.95);
  z-index: 20;
  border-right: 1px solid var(--card-border);
  color: var(--text-secondary);
  font-weight: 500;
}

.day-label-cell span.date-num {
  font-size: 0.8rem;
  opacity: 0.7;
}

.check-cell {
  width: 150px;
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  border-right: 1px solid rgba(255, 255, 255, 0.1);
  padding: 12px 0; /* Add padding here to match label */
}

/* Remove border from the last column */
.habit-col-title:last-child,
.check-cell:last-child {
  border-right: none;
}

.delete-habit-btn {
  color: var(--text-secondary);
  cursor: pointer;
  font-size: 1rem;
  background: none;
  border: none;
  transition: all 0.2s;
  opacity: 0.6;
  margin-top: 4px;
}

.delete-habit-btn:hover {
  color: var(--danger);
  opacity: 1;
  transform: scale(1.1);
}

/* CHECKBOXES */
.checkbox-container {
  display: flex;
  flex-grow: 1;
  justify-content: space-around; /* Match header distribution */
}

.check-cell {
  width: 100px;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-shrink: 0;
}

.custom-checkbox {
  width: 32px;
  height: 32px;
  background: rgba(255, 255, 255, 0.03);
  border: 2px solid var(--card-border);
  border-radius: 8px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.custom-checkbox:hover {
  border-color: var(--accent-light);
  box-shadow: 0 0 10px var(--glow);
  transform: scale(1.05);
}

.custom-checkbox.checked {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  box-shadow: 0 0 20px var(--glow);
  animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.custom-checkbox.checked::after {
  content: "âœ”";
  font-size: 18px;
  color: white;
  font-weight: 800;
  text-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
}

@keyframes popIn {
  0% {
    transform: scale(0.5) rotate(-20deg);
    opacity: 0;
  }
  50% {
    transform: scale(1.2) rotate(10deg);
    opacity: 1;
  }
  100% {
    transform: scale(1) rotate(0deg);
    opacity: 1;
  }
}

.btn-add {
  margin-top: 25px;
  background: rgba(67, 97, 238, 0.1);
  border: 1px dashed var(--accent-light);
  color: var(--accent-light);
  width: 100%;
  padding: 15px;
  border-radius: var(--radius-md);
  cursor: pointer;
  font-weight: 600;
  transition: all 0.3s;
  letter-spacing: 0.5px;
}

.btn-add:hover {
  background: rgba(67, 97, 238, 0.2);
  box-shadow: 0 0 20px var(--glow);
  border-color: var(--accent-blue);
}

/* DASHBOARD STATS */
.dashboard-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: var(--spacing-lg);
}

.stats-card {
  background: var(--card-bg);
  backdrop-filter: blur(10px);
  padding: var(--spacing-lg);
  border-radius: var(--radius-lg);
  border: 1px solid var(--card-border);
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  transition: transform 0.3s;
}

.stats-card:hover {
  transform: translateY(-5px);
  box-shadow:
    0 12px 40px rgba(0, 0, 0, 0.5),
    0 0 20px rgba(67, 97, 238, 0.2);
}

.stats-card h3 {
  width: 100%;
  text-align: left;
  font-size: 1.2rem;
  margin-bottom: 20px;
  color: var(--accent-light);
  border-bottom: 1px solid var(--card-border);
  padding-bottom: 10px;
  font-weight: 600;
}

.progress-card {
  text-align: left;
  align-items: flex-start;
}

.progress-bar-container {
  width: 100%;
  height: 18px;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 9px;
  margin-bottom: 15px;
  box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5);
  overflow: hidden;
}

.progress-bar {
  height: 100%;
  background: linear-gradient(
    90deg,
    var(--accent-secondary),
    var(--accent-light),
    var(--success-check)
  );
  width: 0%;
  transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 0 15px var(--glow);
}

#progressText {
  font-size: 2.5rem;
  font-weight: 700;
  color: var(--text-primary);
  text-shadow: 0 0 20px var(--glow);
}

/* CIRCULAR CHART */
.circle-card {
  align-items: center;
}

.chart-container {
  position: relative;
  width: 160px;
  height: 160px;
  margin: 0 auto;
}

.chart-center-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 1.5rem;
  font-weight: 800;
  color: var(--text-primary);
  text-shadow: 0 0 10px var(--glow);
}

.chart-legend {
  display: flex;
  justify-content: center;
  gap: 15px;
  margin-top: 15px;
  font-size: 0.9rem;
  color: var(--text-secondary);
}

.dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  display: inline-block;
  margin-right: 6px;
  box-shadow: 0 0 5px currentColor;
}

.dot.completed {
  background: var(--accent-light);
  color: var(--accent-light);
}
.dot.missed {
  background: transparent;
  border: 1px solid var(--text-secondary);
  color: var(--text-secondary);
  box-shadow: none;
}

.summary-card {
  align-items: flex-start;
  width: 100%;
}

.insight-row {
  display: flex;
  justify-content: space-between;
  width: 100%;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  font-size: 1rem;
}
.insight-row:last-child {
  border-bottom: none;
  margin-bottom: 0;
}
.insight-row strong {
  color: var(--success-check);
  font-size: 1.2rem;
  text-shadow: 0 0 10px rgba(76, 201, 240, 0.4);
}

/* RESPONSIVE */
.habit-col-header,
.habit-name-cell {
  /* Sticky ensures they stay visible on horizontal scroll */
  position: sticky;
  left: 0;
  z-index: 10;
}
.habit-col-header {
  z-index: 30;
}
/* Ensure background covers scrolling content */

@media print {
  :root {
    --bg-primary: #ffffff;
    --bg-secondary: #f8f9fa;
    --card-bg: #ffffff;
    --card-border: #dddddd;
    --text-primary: #000000;
    --text-secondary: #555555;
    --accent-blue: #000000;
    --accent-light: #333333;
    --accent-secondary: #000000;
    --accent-glow: transparent;
    --glow: transparent;
    --glow-strong: transparent;
    --success-check: #000000;
    --danger: #000000;
  }

  body {
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
    background-color: #fff !important;
    background-image: none !important;
    color: #000 !important;
    padding: 0;
  }

  .app-container {
    width: 100%;
    max-width: 100%;
    padding: 20px;
    box-shadow: none;
    border: none;
    gap: 10px;
  }

  .header-controls,
  .btn-add,
  .tracker-tabs,
  .week-controls button,
  .delete-habit-btn {
    display: none !important;
  }

  /* Make sure week label is visible but buttons are hidden */
  .week-controls {
    justify-content: flex-start;
    margin-bottom: 5px;
  }
  .week-controls span {
    color: #000;
    font-size: 1.2rem;
  }

  .stats-card,
  .tracker-grid-container {
    box-shadow: none !important;
    border: 1px solid #ccc !important;
    backdrop-filter: none;
    background: #fff;
    page-break-inside: avoid;
  }

  .habit-row,
  .grid-header {
    border-color: #eee !important;
    background: #fff !important;
  }

  .date-col-header,
  .day-label-cell,
  .habit-col-title {
    background: #fff !important;
    color: #000 !important;
    border-color: #ccc !important;
  }

  .day-label-cell span {
    color: #000 !important;
  }

  .custom-checkbox {
    border: 2px solid #000 !important;
    background: transparent !important;
  }

  .custom-checkbox.checked {
    background: #000 !important;
    color: #fff !important;
    box-shadow: none !important;
    animation: none !important;
  }

  .habit-name-input {
    color: #000 !important;
    background: transparent !important;
  }

  h1,
  h3,
  strong,
  span,
  label {
    text-shadow: none !important;
    color: #000 !important;
    background: transparent !important; /* Ensure no background on text elements */
  }

  .progress-bar {
    background: #000 !important;
    box-shadow: none !important;
  }
}
